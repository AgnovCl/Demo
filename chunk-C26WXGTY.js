import{a as y,b as X}from"./chunk-BEJHMO3M.js";import{a as C}from"./chunk-SOLGGFDN.js";import{$ as k,D as d,E as e,Eb as Q,F as t,G as w,H as f,I as _,J as m,L as F,M as T,N as i,O as p,P as h,S as M,T as P,U as S,Y as D,Ya as z,Z as V,Za as R,bb as Y,ga as W,kb as H,n as v,na as L,nb as U,o as g,ob as j,pa as A,pb as q,qb as G,u as l,ua as N,va as B,vb as J,w as I,wb as K,y as O,z as x}from"./chunk-KFCX55XD.js";import"./chunk-24WMRY7Q.js";import"./chunk-QUJFQN2Y.js";import"./chunk-PPLOLVG2.js";import"./chunk-WRVDKWF6.js";import"./chunk-YGW4HXY5.js";import"./chunk-BMJVVMK5.js";import"./chunk-S6AMPHJZ.js";import"./chunk-EEG35UFA.js";import"./chunk-WBVABYLX.js";import"./chunk-UD3XTG5V.js";import"./chunk-FOFIWYID.js";import"./chunk-JOTLW5X2.js";import"./chunk-3PF4GKYE.js";import"./chunk-BLSTF7EF.js";import"./chunk-3IVKBF6N.js";import"./chunk-M2X7KQLB.js";import"./chunk-UIFIQKDK.js";import"./chunk-42C7ZIID.js";import"./chunk-C5RQ2IC2.js";import"./chunk-AJI4VUU4.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-BKXINAYE.js";import"./chunk-CKP3SGE2.js";import"./chunk-XF2R5JSX.js";import"./chunk-2R6CW7ES.js";function ee(s,c){if(s&1){let n=f();e(0,"ion-button",19),_("click",function(){v(n);let r=m();return g(r.clearFilters())}),w(1,"ion-icon",20),i(2," Limpiar "),t()}}function te(s,c){if(s&1){let n=f();e(0,"div",21)(1,"div",22)(2,"ion-item",23)(3,"ion-label"),i(4,"N\xFAmero de Serie"),t(),e(5,"ion-input",24),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.numeroSerie,r)||(a.filter.numeroSerie=r),g(r)}),t()(),e(6,"ion-item",23)(7,"ion-label"),i(8,"Tipo Movimiento"),t(),e(9,"ion-select",25),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.tipo,r)||(a.filter.tipo=r),g(r)}),e(10,"ion-select-option",26),i(11,"Todos los tipos"),t(),e(12,"ion-select-option",27),i(13,"Ingreso"),t(),e(14,"ion-select-option",27),i(15,"Egreso"),t(),e(16,"ion-select-option",27),i(17,"Pr\xE9stamo"),t(),e(18,"ion-select-option",27),i(19,"Devoluci\xF3n"),t()()(),e(20,"ion-item",23)(21,"ion-label"),i(22,"Estado"),t(),e(23,"ion-select",28),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.estado,r)||(a.filter.estado=r),g(r)}),e(24,"ion-select-option",26),i(25,"Todos los estados"),t(),e(26,"ion-select-option",27),i(27,"Pendiente"),t(),e(28,"ion-select-option",27),i(29,"Aprobado"),t(),e(30,"ion-select-option",27),i(31,"Rechazado"),t(),e(32,"ion-select-option",27),i(33,"Completado"),t(),e(34,"ion-select-option",27),i(35,"Cancelado"),t()()(),e(36,"ion-item",23)(37,"ion-label"),i(38,"Fecha Desde"),t(),e(39,"ion-datetime",29),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.fechaDesde,r)||(a.filter.fechaDesde=r),g(r)}),t()()(),e(40,"div",22)(41,"ion-item",23)(42,"ion-label"),i(43,"Fecha Hasta"),t(),e(44,"ion-datetime",29),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.fechaHasta,r)||(a.filter.fechaHasta=r),g(r)}),t()(),e(45,"ion-item",23)(46,"ion-label"),i(47,"Ordenar Por"),t(),e(48,"ion-select",30),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.ordenarPor,r)||(a.filter.ordenarPor=r),g(r)}),e(49,"ion-select-option",26),i(50,"Sin ordenar"),t(),e(51,"ion-select-option",31),i(52,"N\xFAmero de Serie"),t(),e(53,"ion-select-option",32),i(54,"Tipo Movimiento"),t(),e(55,"ion-select-option",33),i(56,"Fecha Movimiento"),t(),e(57,"ion-select-option",34),i(58,"Estado"),t()()(),e(59,"ion-item",23)(60,"ion-label"),i(61,"Orden"),t(),e(62,"ion-select",35),S("ngModelChange",function(r){v(n);let a=m();return P(a.filter.orden,r)||(a.filter.orden=r),g(r)}),e(63,"ion-select-option",36),i(64,"Ascendente"),t(),e(65,"ion-select-option",37),i(66,"Descendente"),t()()()(),e(67,"div",38)(68,"ion-button",39),_("click",function(){v(n);let r=m();return g(r.applyFilters())}),w(69,"ion-icon",40),i(70," Aplicar Filtros "),t()()()}if(s&2){let n=m();l(5),M("ngModel",n.filter.numeroSerie),l(4),M("ngModel",n.filter.tipo),l(3),d("value",n.tiposMovimiento.Ingreso),l(2),d("value",n.tiposMovimiento.Egreso),l(2),d("value",n.tiposMovimiento.Prestamo),l(2),d("value",n.tiposMovimiento.Devolucion),l(5),M("ngModel",n.filter.estado),l(3),d("value",n.estadosMovimiento.Pendiente),l(2),d("value",n.estadosMovimiento.Aprobado),l(2),d("value",n.estadosMovimiento.Rechazado),l(2),d("value",n.estadosMovimiento.Completado),l(2),d("value",n.estadosMovimiento.Cancelado),l(5),M("ngModel",n.filter.fechaDesde),l(5),M("ngModel",n.filter.fechaHasta),l(4),M("ngModel",n.filter.ordenarPor),l(14),M("ngModel",n.filter.orden)}}function ie(s,c){s&1&&(e(0,"div",41),w(1,"div",42),e(2,"p"),i(3,"Cargando movimientos..."),t()())}function ne(s,c){if(s&1){let n=f();e(0,"div",43)(1,"h2"),i(2,"Error"),t(),e(3,"p"),i(4),t(),e(5,"button",44),_("click",function(){v(n);let r=m();return g(r.loadMovimientos())}),i(6," \u{1F504} Reintentar "),t()()}if(s&2){let n=m();l(4),p(n.error)}}function oe(s,c){if(s&1&&(e(0,"span",73),i(1),t()),s&2){let n=m().$implicit;l(),h(" ",n.observaciones," ")}}function re(s,c){if(s&1){let n=f();e(0,"tr",50)(1,"td",51)(2,"span",52),i(3),t()(),e(4,"td",53)(5,"span",54),i(6),t()(),e(7,"td",55)(8,"div",56)(9,"span",57),i(10),t(),x(11,oe,2,1,"span",58),t()(),e(12,"td",59)(13,"div",60)(14,"span",61),i(15),t()()(),e(16,"td",62)(17,"div",63)(18,"span",64),i(19),t(),e(20,"span",65),i(21),t()()(),e(22,"td",66),i(23),t(),e(24,"td",67)(25,"span",68),i(26),t()(),e(27,"td",69)(28,"div",70)(29,"button",71),_("click",function(){let r=v(n).$implicit,a=m(2);return g(a.viewMovimiento(r.idMovimiento))}),i(30," \u{1F441}\uFE0F "),t(),e(31,"button",72),_("click",function(){let r=v(n).$implicit,a=m(2);return g(a.editMovimiento(r.idMovimiento))}),i(32," \u270F\uFE0F "),t()()()()}if(s&2){let n=c.$implicit,o=m(2);l(3),p(n.numeroSerie),l(2),T(o.getTipoMovimientoClass(n.tipo)),l(),h(" ",o.getTipoMovimientoText(n.tipo)," "),l(4),p(n.motivo),l(),d("ngIf",n.observaciones),l(4),p(n.ubicacion),l(4),p(n.nombreUsuario),l(2),h("ID: ",n.idUsuario),l(2),h(" ",o.formatDate(n.fecha)," "),l(2),T(o.getEstadoMovimientoClass(n.estado)),l(),h(" ",o.getEstadoMovimientoText(n.estado)," ")}}function ae(s,c){if(s&1){let n=f();e(0,"button",78),_("click",function(){let r=v(n).$implicit,a=m(3);return g(a.goToPage(r))}),i(1),t()}if(s&2){let n=c.$implicit,o=m(3);F("active",n===o.currentPage),l(),h(" ",n," ")}}function le(s,c){if(s&1){let n=f();e(0,"div",74)(1,"button",75),_("click",function(){v(n);let r=m(2);return g(r.previousPage())}),i(2," \u25C0\uFE0F Anterior "),t(),e(3,"div",76),x(4,ae,2,3,"button",77),t(),e(5,"button",75),_("click",function(){v(n);let r=m(2);return g(r.nextPage())}),i(6," Siguiente \u25B6\uFE0F "),t()()}if(s&2){let n=m(2);l(),d("disabled",n.currentPage===1),l(3),d("ngForOf",n.getPageNumbers()),l(),d("disabled",n.currentPage===n.totalPages)}}function se(s,c){if(s&1){let n=f();e(0,"div",79)(1,"div",80),i(2,"\u{1F4E6}"),t(),e(3,"h3"),i(4,"No se encontraron movimientos"),t(),e(5,"p"),i(6,"No hay movimientos que coincidan con los filtros aplicados."),t(),e(7,"button",4),_("click",function(){v(n);let r=m(2);return g(r.clearFilters())}),i(8," Limpiar Filtros "),t()()}}function me(s,c){if(s&1&&(e(0,"div",45)(1,"div",46)(2,"table")(3,"thead")(4,"tr")(5,"th"),i(6,"N\xFAmero Serie"),t(),e(7,"th"),i(8,"Tipo"),t(),e(9,"th"),i(10,"Motivo"),t(),e(11,"th"),i(12,"Ubicaci\xF3n"),t(),e(13,"th"),i(14,"Usuario"),t(),e(15,"th"),i(16,"Fecha"),t(),e(17,"th"),i(18,"Estado"),t(),e(19,"th"),i(20,"Acciones"),t()()(),e(21,"tbody"),x(22,re,33,13,"tr",47),t()()(),x(23,le,7,3,"div",48)(24,se,9,0,"div",49),t()),s&2){let n=m();l(22),d("ngForOf",n.paginatedMovimientos),l(),d("ngIf",n.totalPages>1),l(),d("ngIf",n.paginatedMovimientos.length===0)}}var Pe=(()=>{let c=class c{constructor(o,r){this.movementService=o,this.router=r,this.movimientos=[],this.filteredMovimientos=[],this.isLoading=!1,this.error="",this.filter={},this.showFilters=!1,this.tiposMovimiento=C,this.estadosMovimiento=y,this.currentPage=1,this.itemsPerPage=10,this.totalPages=1}ngOnInit(){this.loadMovimientos()}loadMovimientos(){this.isLoading=!0,this.error="",this.movementService.getMovimientos(this.filter).subscribe({next:o=>{this.movimientos=o,this.filteredMovimientos=o,this.calculatePagination(),this.isLoading=!1},error:o=>{console.error("Error cargando movimientos:",o),this.error="Error al cargar los movimientos",this.isLoading=!1}})}applyFilters(){this.currentPage=1,this.loadMovimientos()}clearFilters(){this.filter={},this.currentPage=1,this.loadMovimientos()}toggleFilters(){this.showFilters=!this.showFilters}formatDate(o){return this.movementService.formatDate(o)}formatDateOnly(o){return this.movementService.formatDateOnly(o)}getTipoMovimientoText(o){return this.movementService.getTipoMovimientoText(o)}getTipoMovimientoClass(o){return this.movementService.getTipoMovimientoClass(o)}getEstadoMovimientoText(o){return this.movementService.getEstadoMovimientoText(o)}getEstadoMovimientoClass(o){return this.movementService.getEstadoMovimientoClass(o)}viewMovimiento(o){this.router.navigate(["/movements",o])}createMovimiento(){this.router.navigate(["/movements/new"])}editMovimiento(o){this.router.navigate(["/movements",o,"edit"])}calculatePagination(){this.totalPages=Math.ceil(this.filteredMovimientos.length/this.itemsPerPage)}get paginatedMovimientos(){let o=(this.currentPage-1)*this.itemsPerPage,r=o+this.itemsPerPage;return this.filteredMovimientos.slice(o,r)}previousPage(){this.currentPage>1&&this.currentPage--}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}goToPage(o){o>=1&&o<=this.totalPages&&(this.currentPage=o)}getPageNumbers(){let o=[],a=Math.max(1,this.currentPage-Math.floor(2.5)),E=Math.min(this.totalPages,a+5-1);E-a+1<5&&(a=Math.max(1,E-5+1));for(let b=a;b<=E;b++)o.push(b);return o}get estadisticas(){let o=this.movimientos.length,r=this.movimientos.filter(u=>u.tipo===C.Ingreso).length,a=this.movimientos.filter(u=>u.tipo===C.Egreso).length,E=this.movimientos.filter(u=>u.tipo===C.Prestamo).length,b=this.movimientos.filter(u=>u.tipo===C.Devolucion).length,Z=this.movimientos.filter(u=>u.estado===y.Completado).length,$=this.movimientos.filter(u=>u.estado===y.Pendiente).length;return{total:o,ingresos:r,egresos:a,prestamos:E,devoluciones:b,completados:Z,pendientes:$}}};c.\u0275fac=function(r){return new(r||c)(I(X),I(W))},c.\u0275cmp=O({type:c,selectors:[["app-movements"]],decls:77,vars:13,consts:[[1,"page-container"],[1,"section-header"],[1,"header-left"],[1,"header-right"],[1,"btn-primary",3,"click"],[1,"card-section"],[1,"card-stat"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-number"],[1,"filters-section"],[1,"filters-header"],["color","primary","fill","outline",3,"click"],["name","funnel-outline","slot","start"],["color","danger","fill","outline",3,"click",4,"ngIf"],["class","filters-content",4,"ngIf"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","table-section",4,"ngIf"],["color","danger","fill","outline",3,"click"],["name","trash-outline","slot","start"],[1,"filters-content"],[1,"filter-row"],["lines","none",1,"filter-group"],["placeholder","Buscar por n\xFAmero de serie...",3,"ngModelChange","ngModel"],["interface","popover","placeholder","Todos los tipos",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["interface","popover","placeholder","Todos los estados",3,"ngModelChange","ngModel"],["display-format","DD-MM-YYYY",3,"ngModelChange","ngModel"],["interface","popover","placeholder","Sin ordenar",3,"ngModelChange","ngModel"],["value","numeroSerie"],["value","tipo"],["value","fecha"],["value","estado"],["interface","popover",3,"ngModelChange","ngModel"],["value","asc"],["value","desc"],[1,"filter-actions"],["color","success",3,"click"],["name","search-outline","slot","start"],[1,"loading"],[1,"spinner"],[1,"error"],[1,"btn-retry",3,"click"],[1,"table-section"],[1,"movements-table"],["class","movement-row",4,"ngFor","ngForOf"],["class","pagination",4,"ngIf"],["class","no-results",4,"ngIf"],[1,"movement-row"],[1,"movement-serial"],[1,"serial-number"],[1,"movement-type"],[1,"type-badge"],[1,"movement-reason"],[1,"reason-info"],[1,"reason"],["class","observations",4,"ngIf"],[1,"movement-location"],[1,"location-info"],[1,"location"],[1,"movement-user"],[1,"user-info"],[1,"user-name"],[1,"user-id"],[1,"movement-date"],[1,"movement-status"],[1,"status-badge"],[1,"movement-actions"],[1,"action-buttons"],["title","Ver detalles",1,"btn-view",3,"click"],["title","Editar",1,"btn-edit",3,"click"],[1,"observations"],[1,"pagination"],[1,"btn-page",3,"click","disabled"],[1,"page-numbers"],["class","btn-page-number",3,"active","click",4,"ngFor","ngForOf"],[1,"btn-page-number",3,"click"],[1,"no-results"],[1,"no-results-icon"]],template:function(r,a){r&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1"),i(4,"\u{1F4E6} Movimientos"),t(),e(5,"p"),i(6,"Gesti\xF3n completa de movimientos del inventario"),t()(),e(7,"div",3)(8,"button",4),_("click",function(){return a.createMovimiento()}),i(9," \u2795 Nuevo Movimiento "),t()()(),e(10,"div",5)(11,"div",6)(12,"div",7),i(13,"\u{1F4E6}"),t(),e(14,"div",8)(15,"h3"),i(16,"Total Movimientos"),t(),e(17,"p",9),i(18),t()()(),e(19,"div",6)(20,"div",7),i(21,"\u{1F4E5}"),t(),e(22,"div",8)(23,"h3"),i(24,"Ingresos"),t(),e(25,"p",9),i(26),t()()(),e(27,"div",6)(28,"div",7),i(29,"\u{1F4E4}"),t(),e(30,"div",8)(31,"h3"),i(32,"Egresos"),t(),e(33,"p",9),i(34),t()()(),e(35,"div",6)(36,"div",7),i(37,"\u{1F504}"),t(),e(38,"div",8)(39,"h3"),i(40,"Pr\xE9stamos"),t(),e(41,"p",9),i(42),t()()(),e(43,"div",6)(44,"div",7),i(45,"\u21A9\uFE0F"),t(),e(46,"div",8)(47,"h3"),i(48,"Devoluciones"),t(),e(49,"p",9),i(50),t()()(),e(51,"div",6)(52,"div",7),i(53,"\u2705"),t(),e(54,"div",8)(55,"h3"),i(56,"Completados"),t(),e(57,"p",9),i(58),t()()(),e(59,"div",6)(60,"div",7),i(61,"\u23F3"),t(),e(62,"div",8)(63,"h3"),i(64,"Pendientes"),t(),e(65,"p",9),i(66),t()()()(),e(67,"div",10)(68,"div",11)(69,"ion-button",12),_("click",function(){return a.toggleFilters()}),w(70,"ion-icon",13),i(71),t(),x(72,ee,3,0,"ion-button",14),t(),x(73,te,71,16,"div",15),t(),x(74,ie,4,0,"div",16)(75,ne,7,1,"div",17)(76,me,25,3,"div",18),t()),r&2&&(l(18),p(a.estadisticas.total),l(8),p(a.estadisticas.ingresos),l(8),p(a.estadisticas.egresos),l(8),p(a.estadisticas.prestamos),l(8),p(a.estadisticas.devoluciones),l(8),p(a.estadisticas.completados),l(8),p(a.estadisticas.pendientes),l(5),h(" ",a.showFilters?"Ocultar":"Mostrar"," Filtros "),l(),d("ngIf",a.showFilters),l(),d("ngIf",a.showFilters),l(),d("ngIf",a.isLoading),l(),d("ngIf",a.error&&!a.isLoading),l(),d("ngIf",!a.isLoading&&!a.error))},dependencies:[k,D,V,N,L,A,B,Q,Y,H,U,j,q,G,J,K,z,R],styles:[".no-results[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;background:var(--bg-primary)}.no-results[_ngcontent-%COMP%]   .no-results-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;opacity:.5}.no-results[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--text-primary);margin-bottom:1rem}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin-bottom:2rem}.no-results[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:var(--primary-gradient);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:var(--border-radius-sm);font-size:1rem;font-weight:600;cursor:pointer;transition:var(--transition)}.no-results[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #667eea66}@media (max-width: 768px){.movements-container[_ngcontent-%COMP%]{padding:1rem}.movements-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;text-align:center}.movements-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.movements-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem;font-size:.8rem}.movements-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .movement-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;font-size:.9rem}.pagination[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}}.page-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.section-header[_ngcontent-%COMP%]{margin-bottom:32px;text-align:center;background:var(--bg-primary);border-radius:var(--border-radius);box-shadow:var(--shadow-light);padding:2rem 1rem;border:1px solid var(--border-color)}.section-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:var(--text-primary);margin:0 0 8px}.section-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:var(--text-secondary);margin:0}.card-section[_ngcontent-%COMP%], .movements-content[_ngcontent-%COMP%], .movements-table[_ngcontent-%COMP%], .filters-section[_ngcontent-%COMP%]{background:var(--bg-primary);border-radius:var(--border-radius);box-shadow:var(--shadow-light);border:1px solid var(--border-color)}"]});let s=c;return s})();export{Pe as MovementsPage};
